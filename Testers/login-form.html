<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login Form</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.1/cdn/themes/light.css" />
  <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.1/cdn/shoelace.js"></script>
  <link href="./../css/base.css" rel="stylesheet">
  <link href="./../css/index.css" rel="stylesheet">
  <link href="./../css/shoelace_customized.css" rel="stylesheet">
  <script type="module" src="./../components/smart/login-form.js"></script>
</head>
<body>
  <login-form
    options="local,google,facebook,guest,signup"
    dialog-title="Welcome to FlashCardX"
    auto-close
  ></login-form>

  <div id="user-info"></div>
  <button onclick="callProtected()">Call API</button>
  <pre id="output"></pre> <!-- ‚úÖ Added output element -->

  <script>
    document.querySelector('login-form').addEventListener('login-success', (e) => {
      const { provider, email, userId } = e.detail;
      console.log('‚úÖ Logged in via:', provider);
      console.log('üìß Email:', email);
      console.log('üÜî User ID:', userId);

      document.getElementById('user-info').textContent = `Welcome, ${email}`;
    });

    function callProtected() {
      fetch('https://php.adapps.download/api/protected.php', {
        method: 'GET',
        credentials: 'include' // üîë required for cross-domain cookies
      })
        .then(res => res.json())
        .then(data => {
          console.log(data);
          document.getElementById('output').textContent = JSON.stringify(data, null, 2);
        })
        .catch(err => console.error('‚ùå API error:', err)); // ‚úÖ Proper catch
    }
  </script>
</body>
</html>
